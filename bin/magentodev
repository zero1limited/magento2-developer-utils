#!/usr/bin/php
<?php

if(php_sapi_name() !== 'cli') {
    exit;
}

if(isset($_SERVER['SCRIPT_NAME'])){
    $root_app = $_SERVER['SCRIPT_NAME'];
    do{
        $root_app = dirname($root_app);
    }while($root_app !== '/' && basename($root_app) != 'vendor');

    if($root_app == '/'){
        throw new \Exception('Unable to find vendor directory');
    }
}else{
    throw new \Exception('SCRIPT_NAME not set');
}
if(!is_file($root_app . '/autoload.php')){
    throw new \Exception('Unable to find autoload.php ('.$root_app . '/autoload.php)');
}
require $root_app . '/autoload.php';

$kernel = new \Zero1\MagentoDev\Kernel('dev', true);
$kernel->boot();

$container = $kernel->getContainer();
$application = $container->get(\Symfony\Component\Console\Application::class);
$application->run();
